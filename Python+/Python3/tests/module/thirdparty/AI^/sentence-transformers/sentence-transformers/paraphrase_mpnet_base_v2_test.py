from numpy import ndarray
from sentence_transformers import SentenceTransformer


# https://huggingface.co/sentence-transformers/paraphrase-mpnet-base-v2
def test_use_model():
    sentences: list[str] = ["This is an example sentence", "Each sentence is converted"]
    model: SentenceTransformer = SentenceTransformer('sentence-transformers/paraphrase-mpnet-base-v2')
    embeddings: ndarray = model.encode(sentences)
    embeddings_list: list[list[float]] = embeddings.tolist()
    print(embeddings_list)


def test_hello_embeddings():
    sentences: list[str] = ["hello"]
    model: SentenceTransformer = SentenceTransformer('sentence-transformers/paraphrase-mpnet-base-v2')
    embeddings: ndarray = model.encode(sentences)
    embeddings_list: list[list[float]] = embeddings.tolist()
    assert len(embeddings_list[0]) == 768
    assert embeddings_list == [
        [-0.09998222440481186, 0.013605733402073383, -0.02748584747314453, 0.11394969373941422, 0.09827158600091934,
         0.0045499601401388645, -0.08009374886751175, -0.034696996212005615, 0.18628816306591034, 0.04024245962500572,
         -0.013883247971534729, -0.10835140943527222, -0.07355497032403946, 0.06167103722691536, 0.16575227677822113,
         -0.23663854598999023, 0.07913875579833984, 0.03288745507597923, -0.24483871459960938, -0.04598084092140198,
         -0.022317292168736458, -0.004778016358613968, -0.02181018702685833, -0.09636226296424866, 0.07145481556653976,
         0.09664084762334824, -0.09420963376760483, 0.15176205337047577, 0.1285252720117569, 0.11073603481054306,
         0.1578371226787567, 0.026866966858506203, 0.00488146161660552, 0.054226890206336975, 0.17641639709472656,
         -0.019618205726146698, -0.042082685977220535, 0.013646484352648258, -0.10602355003356934, -0.15810741484165192,
         0.11817830055952072, -0.08856170624494553, -0.13097669184207916, 0.08482299000024796, -0.172201469540596,
         -0.12561148405075073, 0.09553948044776917, -0.14257918298244476, -0.05693135783076286, 0.10623931884765625,
         0.0673031210899353, 0.24423570930957794, 0.03692099452018738, 0.05543273314833641, 0.23897135257720947,
         0.14046849310398102, -0.01670990325510502, -0.007631793152540922, 0.0460662841796875, -0.06024491786956787,
         0.08179745823144913, -0.01839960180222988, -0.012160112150013447, -0.18633054196834564, -0.004542462527751923,
         0.10957144945859909, 0.34582439064979553, -0.05022202059626579, -0.07279158383607864, -0.04359777271747589,
         0.21628278493881226, 0.1588280200958252, -0.13149984180927277, 0.2451072782278061, 0.06164552643895149,
         -0.0013582309475168586, 0.0923440232872963, -0.08769672363996506, -0.013030372560024261, -0.08210986107587814,
         -0.1173485741019249, -0.06931495666503906, -0.02304639108479023, 0.13137829303741455, -0.13174092769622803,
         0.1000657007098198, -0.025430893525481224, -0.07827351242303848, -0.24733491241931915, -0.019857626408338547,
         -0.07243409752845764, 0.10917094349861145, 0.008430053479969501, 0.001043591066263616, 0.12888872623443604,
         0.03175981715321541, 0.03897702693939209, 0.022019125521183014, 0.04628719389438629, -0.032004665583372116,
         0.17244063317775726, 0.15978454053401947, 0.014412518590688705, -0.06629607081413269, 0.09740340709686279,
         -0.19567449390888214, 0.19683526456356049, -0.31675565242767334, -0.07242120057344437, -0.07775083184242249,
         0.008307225070893764, -0.02211332879960537, 0.08089228719472885, 0.06033673509955406, -0.017776204273104668,
         -0.11287716031074524, 0.18114835023880005, 0.06571375578641891, 0.21061956882476807, -0.04795089364051819,
         0.2131199836730957, -0.052937205880880356, -0.0636386051774025, 0.07286226749420166, -0.07813924551010132,
         -0.00581332528963685, -0.16083715856075287, 0.00369267538189888, -0.03436499461531639, -0.10754963010549545,
         -0.04460734501481056, -0.10851537436246872, 0.06773089617490768, 0.08182396739721298, 0.11824426054954529,
         -0.19234265387058258, -0.08545710891485214, -0.08935802429914474, 0.2151528000831604, -0.09149658679962158,
         -0.042214006185531616, 0.0584372878074646, -0.025589972734451294, 0.017801640555262566, 0.08351752907037735,
         -0.11852095276117325, -0.001045912504196167, -0.00578664056956768, 0.004919407423585653, -0.00391132989898324,
         0.21120993793010712, 0.14276587963104248, -0.4027877151966095, 0.07575094699859619, 0.11252018064260483,
         -0.08421706408262253, 0.21606291830539703, -0.21343301236629486, -0.18560592830181122, -0.15262620151042938,
         0.037955451756715775, 0.10277257114648819, -0.0148051418364048, 0.08385742455720901, 0.1205928847193718,
         -0.03141169622540474, 0.009944763034582138, -0.2084101289510727, 0.029124140739440918, -0.11211413145065308,
         -0.15480488538742065, 0.06054822728037834, 0.03802483156323433, -0.06749456375837326, 0.12359569221735,
         0.009692500345408916, -0.2937294542789459, -0.1500348150730133, -0.10232285410165787, 0.01655481569468975,
         -0.09937632083892822, -0.11976765841245651, -0.10461243987083435, 0.008606147952377796, -0.09253060072660446,
         0.05251845717430115, 0.010900451801717281, 0.057488784193992615, -0.03872665390372276, 0.09927331656217575,
         -0.0077813491225242615, -0.04300127550959587, -0.17385314404964447, 0.1675698310136795, 0.0009173604776151478,
         -0.11599377542734146, -0.012903246097266674, -0.1632487177848816, 0.13708876073360443, -0.007532128598541021,
         -0.062088578939437866, -0.1301000416278839, 0.21377182006835938, 0.09571272134780884, -0.09895419329404831,
         0.13553328812122345, 0.08443757146596909, 0.012051042169332504, 0.017293168231844902, 0.13725346326828003,
         0.3406433165073395, 0.07941753417253494, 0.09006073325872421, 0.08848554641008377, 0.04628151282668114,
         0.191975399851799, 0.12479862570762634, 0.15856073796749115, 0.05753543972969055, 0.23876239359378815,
         -0.0790100172162056, 0.0844404399394989, 0.10330914705991745, -0.03811663016676903, 0.07906114310026169,
         0.06207755208015442, 0.11379730701446533, -0.017789512872695923, 0.05205222964286804, -0.02330392599105835,
         0.010161136277019978, 0.0394466370344162, 0.15763290226459503, 0.10128732770681381, -0.13929612934589386,
         0.12250649183988571, -0.023968666791915894, -0.24213576316833496, 0.2884388267993927, -0.22623252868652344,
         -0.07541809231042862, 0.02305409125983715, -0.010709094814956188, 0.07722526043653488, 0.18348145484924316,
         0.0033966004848480225, -0.04688294604420662, -0.07060462981462479, 0.1670514941215515, 0.040794625878334045,
         0.04757125303149223, 0.07031732052564621, -0.153834268450737, -0.02762976847589016, 0.03653081879019737,
         -0.01396853756159544, 0.007409439887851477, -0.1557849645614624, 0.03961733356118202, -0.12058266252279282,
         -0.11060895770788193, -0.02987568825483322, 0.06592310220003128, -0.07937603443861008, 0.04170139506459236,
         0.05695410072803497, 0.14381520450115204, -0.2924046814441681, -0.13369260728359222, 0.016258319839835167,
         0.08189163357019424, 0.056727245450019836, 0.06453143805265427, 0.06890294700860977, 0.13677848875522614,
         -0.009450656361877918, 0.1267157346010208, -0.06568954885005951, -0.1195250079035759, 0.13358233869075775,
         -0.0658908486366272, 0.05176954343914986, -0.20590968430042267, -0.026756882667541504, -0.03969617560505867,
         0.07497245818376541, 0.10180202126502991, -0.20990653336048126, 0.16331757605075836, -0.2593948543071747,
         0.0631217360496521, 0.02813589572906494, 0.05958332493901253, -0.07609334588050842, 0.02845032513141632,
         -0.07320720702409744, -0.01846885494887829, 0.15824824571609497, 0.0004595665668603033, -0.03488575294613838,
         0.05517861247062683, 0.09764999151229858, 0.01267699059098959, 0.01937905140221119, 0.0733080729842186,
         -0.0480860136449337, 0.16375571489334106, -0.17010943591594696, 0.019969193264842033, -0.04445173218846321,
         -0.028866266831755638, 0.020667657256126404, -0.019480088725686073, 0.2336450070142746, 0.003962917719036341,
         -0.012334371916949749, -0.07746128737926483, -0.06890103965997696, 0.051950424909591675, -0.05410441756248474,
         -0.020733704790472984, -0.07106626778841019, 0.1824546605348587, 0.02769089676439762, -0.14284290373325348,
         0.12663856148719788, 0.006041729357093573, 0.073625847697258, 0.039988238364458084, -0.06515377759933472,
         0.09152933210134506, 0.1909749060869217, -0.024527674540877342, 0.00046039558947086334, -0.21251718699932098,
         -0.06057695671916008, 0.06703652441501617, -0.1637723296880722, -0.1627594381570816, 0.09392645210027695,
         -0.11524064093828201, -0.1956639438867569, 0.09757864475250244, -0.16517911851406097, -0.2601044476032257,
         0.050543736666440964, -0.09123099595308304, -0.05427372828125954, -0.1301996111869812, -0.016328027471899986,
         -0.23409150540828705, 0.05787557363510132, 0.0812348797917366, -0.11490494012832642, 0.021674884483218193,
         -0.15422828495502472, -0.11859044432640076, 0.2651515007019043, -0.005959675181657076, -0.07024148851633072,
         -0.04751153662800789, -0.15998265147209167, -0.061185311526060104, 0.14573366940021515, 0.16145522892475128,
         0.10329300165176392, 0.03599734231829643, -0.009788784198462963, -0.08976580947637558, 0.02248229645192623,
         0.012715018354356289, 0.07223431020975113, -0.10158482193946838, 0.07969827204942703, 0.1409318894147873,
         -0.09120456129312515, -0.007338463794440031, -0.16816802322864532, -0.04540739580988884, -0.07442829012870789,
         -0.10721828788518906, -0.09476468712091446, 0.13581714034080505, 0.010338312946259975, 0.009410598315298557,
         0.04408775642514229, 0.0024468691553920507, 0.012190267443656921, 0.10183850675821304, -0.04783310368657112,
         -0.040210381150245667, -0.16931678354740143, -0.043263327330350876, 0.07253991812467575, 0.03186158090829849,
         0.14623910188674927, 0.10263700038194656, 0.20577745139598846, -0.10449709743261337, 0.018014302477240562,
         -0.12579955160617828, 0.43158963322639465, -0.09579359740018845, -0.032452378422021866, -0.03334967792034149,
         0.04235940799117088, 0.3291325569152832, 0.028348462656140327, 0.12546199560165405, 0.08811243623495102,
         -0.29108142852783203, -0.0892731249332428, 0.22096671164035797, 0.011806699447333813, -0.16780471801757812,
         -0.1344449520111084, 0.032414812594652176, -0.1486203521490097, -0.02652558498084545, -0.3162970244884491,
         -0.02168160490691662, 0.06453657895326614, -0.042240459471940994, 0.09840250015258789, -0.04697077348828316,
         -0.060004234313964844, 0.06623570621013641, 0.08315704017877579, -0.0012931587407365441, -0.08623641729354858,
         0.003516359953209758, 0.03776076063513756, 0.20508162677288055, 0.19244801998138428, -0.07832148671150208,
         0.11078837513923645, 0.007584638427942991, 0.045320432633161545, -0.06093414127826691, -0.03539097681641579,
         -0.0798267126083374, -0.19731830060482025, 0.22417151927947998, 0.033175695687532425, 0.002254582941532135,
         0.2627849578857422, -0.15675805509090424, -0.11743608862161636, 0.15993617475032806, -0.06711321324110031,
         0.06745225936174393, -0.24097104370594025, -0.03200088441371918, 0.025086255744099617, -0.029256075620651245,
         -0.02598188817501068, -0.11117175221443176, 0.3484766483306885, -0.009753085672855377, -0.08151204884052277,
         0.09567561000585556, 0.22171324491500854, -0.09636286646127701, 0.06515774875879288, -0.023447582498192787,
         -0.13624133169651031, -0.018581056967377663, 0.10728916525840759, 0.17852140963077545, -0.0865396037697792,
         -0.28468966484069824, 0.06355708837509155, 0.007940790615975857, 0.07628331333398819, -0.11461180448532104,
         0.10153836011886597, -0.25634217262268066, -0.10834107547998428, -0.235970601439476, -0.06097104027867317,
         0.02669697441160679, -0.11662134528160095, 0.0790577307343483, 0.09342648833990097, -0.041583966463804245,
         -0.13790321350097656, 0.15887890756130219, -0.061077382415533066, -0.05255123972892761, -0.01122691947966814,
         -0.03185345232486725, -0.05859345197677612, -0.009967016987502575, 0.09925592690706253, -0.209459587931633,
         0.2347232550382614, 0.07306010276079178, -0.021582311019301414, -0.35114753246307373, -0.1122119352221489,
         -0.009024848230183125, -0.035339921712875366, 0.006910326424986124, -0.11765056848526001, 0.07744726538658142,
         -0.10771554708480835, 0.015056677162647247, -0.034982383251190186, 0.034347593784332275, -0.029654687270522118,
         0.02883017063140869, 0.09876484423875809, 0.0708039328455925, -0.18751318752765656, 0.0207966361194849,
         0.1880386471748352, 0.028928950428962708, 0.12558339536190033, 0.048713911324739456, -0.018996214494109154,
         0.046988412737846375, -0.01678699441254139, -0.029782762750983238, 0.17899441719055176, -0.09275752305984497,
         0.22392265498638153, 0.013676845468580723, 0.0003757355734705925, 0.03828461095690727, 0.0649300292134285,
         -0.5005709528923035, -0.0062735676765441895, 0.09598633646965027, 0.11467669159173965, -0.0783817246556282,
         0.2176571637392044, 0.02721189148724079, 0.22670328617095947, -0.03192144259810448, 0.08123303204774857,
         0.08102653175592422, 0.03919963166117668, 0.24578340351581573, 0.0005894278292544186, 0.06652902811765671,
         0.21041977405548096, 0.08579465001821518, 0.043222445994615555, -0.06855332106351852, -0.13914144039154053,
         0.058747753500938416, 0.127894327044487, -0.09621188789606094, 0.03445224091410637, -0.053982216864824295,
         -0.192843958735466, -0.07283788919448853, -0.11915991455316544, -0.1604817658662796, -0.2392922043800354,
         -0.06704173982143402, -0.13659881055355072, -0.13036364316940308, 0.16718001663684845, -0.06274748593568802,
         0.037278275936841965, -0.12247449904680252, 0.11503330618143082, 0.13989882171154022, 0.07142408937215805,
         -0.1475628763437271, 0.02607748657464981, 0.1788244992494583, 0.11818776279687881, 0.05928567424416542,
         0.0006790992920286953, -0.011659413576126099, -0.05820315703749657, 0.008264751173555851, -0.05228865146636963,
         0.17024405300617218, -0.012280535884201527, 0.0013776322593912482, 0.002810134319588542, 0.001546259387396276,
         0.07858862727880478, -0.11209693551063538, 0.16654543578624725, -0.02340530790388584, 0.31611451506614685,
         0.01213423628360033, 0.3107447326183319, 0.14684635400772095, -0.04187256097793579, -0.02974008210003376,
         -0.047757890075445175, 0.03632483258843422, 0.04499007388949394, 0.12011021375656128, -0.03942486271262169,
         -0.01113258395344019, -0.0007978205685503781, -0.026338012889027596, 0.05344349518418312,
         -0.0005733867292292416, 0.04337261989712715, -0.1746462732553482, 0.08068240433931351, -0.033271271735429764,
         -0.2011597603559494, -0.04498272016644478, -0.046633291989564896, 0.14090295135974884, -0.15774255990982056,
         0.21465076506137848, -0.07836887240409851, 0.14697681367397308, -0.05309571698307991, -0.07493831217288971,
         -0.05888386443257332, 0.019322777166962624, -0.09391111135482788, -0.009511791169643402, -0.0359867662191391,
         0.01568012684583664, -0.037181392312049866, 0.061675846576690674, 0.11015921831130981, 0.0183249581605196,
         0.05535511299967766, -0.20512978732585907, 0.13742773234844208, -0.05620962753891945, -0.03859306499361992,
         0.21563071012496948, 0.05479660630226135, 0.09548095613718033, -0.0408257357776165, -0.017707644030451775,
         0.08259260654449463, -0.22485709190368652, 0.06585944443941116, -0.06891139596700668, -0.03045942820608616,
         0.01294400542974472, -0.05787348747253418, -0.23965857923030853, -0.2373339682817459, 0.0017432570457458496,
         0.0004221200942993164, -0.05214976146817207, 0.018657783046364784, -0.007499755825847387, -0.0884888768196106,
         0.01501659955829382, -0.08446452766656876, 0.03176146373152733, -0.03243142366409302, -0.17860175669193268,
         -0.03729806840419769, -0.07320219278335571, 0.1063808798789978, -0.04382094740867615, 0.03300943598151207,
         -0.02697647549211979, 0.03331490978598595, -0.05869681015610695, 0.04502224922180176, 0.07853338122367859,
         0.13042064011096954, -0.034749653190374374, -0.004880317021161318, -0.03939791023731232, 0.1904885619878769,
         -0.07851511240005493, -0.041331369429826736, -0.024174338206648827, 0.054477348923683167, -0.08347124606370926,
         0.028199145570397377, -0.23305267095565796, 0.11399710178375244, -0.04033040627837181, 0.0016519048949703574,
         0.10742411017417908, 0.045690715312957764, -0.017871832475066185, -0.015400758944451809, 0.05025206878781319,
         -0.05540461465716362, -0.008246351033449173, 0.058777276426553726, 0.2452063113451004, -0.00926712341606617,
         -0.009624707512557507, 0.04348117485642433, 0.08206141740083694, 0.045439332723617554, 0.15869304537773132,
         -0.1339440792798996, -0.04779936373233795, -0.045606836676597595, -0.08467181771993637, -0.10075702518224716,
         -0.2978813648223877, -0.15786074101924896, -0.14645610749721527, -0.057154834270477295, 0.07251977175474167,
         0.0603422187268734, 0.0630754753947258, 0.008474486880004406, -0.022926317527890205, 0.07230103015899658,
         -0.05345539376139641, 0.03087703138589859, -0.07627696543931961, 0.0982556939125061, 0.0034484013449400663,
         -0.022385982796549797, -0.06702225655317307, 0.0941997691988945, 0.06784933805465698, 0.06643352657556534,
         0.06647873669862747, -0.014049994759261608, 0.18586613237857819, 0.023786336183547974, 0.008408892899751663,
         -0.061992134898900986, 0.08989334851503372, -0.06088229641318321, -0.005160242319107056, 0.17393098771572113,
         -0.0632425993680954, 0.03735889121890068, 0.06379839777946472, -0.0916912630200386, -0.08858976513147354,
         0.1103706881403923, -0.10598202794790268, 0.037333421409130096, 0.09599802643060684, 0.049459975212812424,
         -0.06935738772153854, -0.022717267274856567, -0.0485881008207798, 0.07209032773971558, -0.1952265501022339,
         -0.08915481716394424, -0.07329101115465164, 0.06101281940937042, 0.03222950920462608, -0.12297440320253372,
         0.03225572034716606, -0.0857032760977745, 0.1689225286245346, -0.1087179109454155, 0.21997714042663574,
         -0.016699781641364098, 0.17080815136432648, 0.15490677952766418, -0.03828165680170059, -0.02930593676865101,
         0.11931338906288147, 0.18174929916858673, -0.003925304394215345, -0.1344914436340332]]
