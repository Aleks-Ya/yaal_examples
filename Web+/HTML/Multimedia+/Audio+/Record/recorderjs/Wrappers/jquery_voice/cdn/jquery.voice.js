(function($){$.extend({voice:{workerPath:"cdn/recorderWorker.js",initCalled:false,stream:false,init:function(){try{window.AudioContext=window.AudioContext||window.webkitAudioContext;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;window.URL=window.URL||window.webkitURL;if(navigator.getUserMedia===false){alert('getUserMedia() is not supported in your browser');}
$.voice.context=new AudioContext();}
catch(e){alert('Web Audio API is not supported in this browser');}},record:function(output,callback){if($.voice.initCalled===false){this.init();$.voice.initCalled=true;}
navigator.getUserMedia({audio:true},function(stream){var input=$.voice.context.createMediaStreamSource(stream);if(output===true){input.connect($.voice.context.destination);}
$.voice.recorder=new Recorder(input,{workerPath:$.voice.workerPath});$.voice.stream=stream;$.voice.recorder.record();callback(stream);},function(){alert('No live audio input');});},stop:function(){$.voice.recorder.stop();$.voice.recorder.clear();$.voice.stream.stop();return $.voice;},export:function(callback,type){$.voice.recorder.exportWAV(function(blob){if(type==""||type=="blob"){callback(blob);}else if(type=="URL"){var url=URL.createObjectURL(blob);callback(url);}});}}});})(jQuery);